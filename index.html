<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TOKYO TRIP 2025</title>
    
    <!-- 設定 iOS 主畫面圖示 (使用一個酷炫的 BP 風格圖示) -->
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3014/3014239.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Noto+Sans+TC:wght@300;400;700&family=Rubik:wght@400;700&display=swap" rel="stylesheet">

    <!-- React & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind Config for BP Theme -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bp-black': '#121212',
                        'bp-dark': '#1e1e1e',
                        'bp-pink': '#FF69B4', // Hot Pink
                        'bp-soft-pink': '#F8C8DC',
                        'bp-coffee': '#6F4E37',
                        'bp-coffee-light': '#A67B5B',
                    },
                    fontFamily: {
                        'heading': ['"Fredoka One"', 'sans-serif'],
                        'body': ['"Rubik"', '"Noto Sans TC"', 'sans-serif'],
                    },
                    boxShadow: {
                        'glow': '0 0 10px rgba(255, 105, 180, 0.5)',
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.5)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: 'Rubik', 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 80px; /* Space for bottom nav */
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        ::-webkit-scrollbar-thumb {
            background: #6F4E37;
            border-radius: 3px;
        }

        .gradient-text {
            background: linear-gradient(to right, #FF69B4, #A67B5B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .bp-card {
            background: #1e1e1e;
            border-left: 4px solid #FF69B4;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }
        
        .coffee-card {
            background: #1e1e1e;
            border-left: 4px solid #6F4E37;
            border-radius: 0.5rem;
        }

        .floating-action {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* Tabs transition */
        .tab-content {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Data ---
        const INITIAL_DATA = {
            transport: {
                hsr: {
                    title: "高鐵 & 機捷",
                    outbound: "1/16 台中(22:24) -> 桃園(23:23) 車次862",
                    mrt: "A18高鐵桃園站(23:34) -> A12機場一航(23:55)"
                },
                flight: {
                    outbound: {
                        date: "1/16",
                        airline: "樂桃 MM620",
                        time: "02:25 起飛 (T1) -> 06:30 抵達 (成田T1)"
                    },
                    inbound: {
                        date: "1/19",
                        airline: "星宇 JX805",
                        time: "20:10 起飛 -> 23:20 抵達 (桃園)"
                    }
                },
                hotel: {
                    name: "三井花園飯店日本橋普米爾",
                    address: "東京都中央區日本橋室町3-4-4",
                    tel: "+81 3-3270-1131",
                    note: "1/16 - 1/19 (3晚)"
                }
            },
            itinerary: [
                {
                    day: "DAY 1",
                    date: "1/16 (四)",
                    title: "抵達 & BLACKPINK 演唱會",
                    events: [
                        { time: "06:30", title: "抵達成田機場 T1", type: "transport" },
                        { time: "07:37", title: "搭乘 NEX 前往東京車站", note: "備選: 08:12, 08:49 (需換票)", type: "transport" },
                        { time: "10:00", title: "飯店寄放行李", address: "東京都中央區日本橋室町3-4-4", type: "hotel" },
                        { time: "12:00", title: "午餐時間", note: "周邊探索" },
                        { time: "16:30", title: "BLACKPINK 演唱會", address: "Tokyo Dome", type: "highlight" },
                        { time: "20:00", title: "晚餐", note: "視演唱會結束時間而定" }
                    ]
                },
                {
                    day: "DAY 2",
                    date: "1/17 (五)",
                    title: "富士山網美一日遊",
                    events: [
                        { time: "08:00", title: "集合出發 (切勿遲到)", address: "JR東京站丸之內南口", type: "highlight", note: "一日遊巴士接送" },
                        { time: "10:30", title: "天梯小鎮 & 羅森便利店", note: "網紅打卡點" },
                        { time: "12:30", title: "忍野八海", note: "欣賞富士山泉水" },
                        { time: "14:30", title: "河口湖", note: "湖畔美景" },
                        { time: "18:00", title: "返回東京" }
                    ]
                },
                {
                    day: "DAY 3",
                    date: "1/18 (六)",
                    title: "輕井澤購物 & 美食",
                    events: [
                        { time: "07:26", title: "北陸新幹線 (上野出發)", note: "備選: 07:30, 07:58, 08:18, 08:26", type: "transport" },
                        { time: "09:00", title: "輕井澤王子購物廣場", note: "全日購物行" },
                        { time: "18:00", title: "返回東京", type: "transport" }
                    ]
                },
                {
                    day: "DAY 4",
                    date: "1/19 (日)",
                    title: "最後採買 & 回家",
                    events: [
                        { time: "10:00", title: "退房 & 寄放行李", type: "hotel" },
                        { time: "11:00", title: "隨興逛街", note: "補齊購物清單" },
                        { time: "16:00", title: "前往機場", type: "transport" },
                        { time: "20:10", title: "搭機回台 (JX805)", type: "flight" }
                    ]
                }
            ],
            foods: [
                { area: "池袋", name: "yellow池袋店 (蛋包飯)", address: "Tokyo, Toshima City, Higashiikebukuro, 1 Chome−27−5 関口ビル Ｂ号室" },
                { area: "淺草", name: "Ginza Brazil (炸豬排三明治)", address: "Tokyo, Taito City, Asakusa, 1 Chome−28−2 シカゴビル", note: "老字號咖啡店" },
                { area: "淺草", name: "Pelican CAFÉ (早午餐)", address: "Tokyo, Taito City, Kotobuki, 3 Chome−9−11 1階" },
                { area: "下北澤", name: "Kokochi", address: "5 Chome-29-8 Daizawa, Setagaya City, Tokyo" },
                { area: "上野", name: "American Diner Andra (漢堡排)", address: "5 Chome-13-7 Higashiueno, Taito City, Tokyo" },
                { area: "白金", name: "A5 和牛焼肉 KIM", address: "2 Chome-2-2 Shirokane, Minato City, Tokyo" },
                { area: "銀座", name: "銀座Sun-mi 香川壽喜燒", address: "Tokyo, Chuo City, Ginza, 6 Chome−3−9-4 階5階" },
                { area: "銀座", name: "Bills銀座", address: "東京都中央區銀座 2-6-12 Okura House 12F" },
                { area: "湯島", name: "蟹食放題 ごっつお", address: "東京都文京區湯島ライワビル 4F" }
            ],
            places: [
                { area: "世田谷", name: "豪德寺 (招財貓)", address: "東京都世田谷區豪德寺2-24-7" },
                { area: "淺草", name: "今戶神社 (戀愛神社)", address: "東京都台東區今戶1丁目5-22" },
                { area: "淺草", name: "淺草寺 雷門", address: "2 Chome-3-1 Asakusa, Taito City, Tokyo" },
                { area: "原宿", name: "Onitsuka Tiger", address: "Tokyo, Shibuya, Jingumae, 4 Chome−24−14", tag: "SHOP" },
                { area: "新宿", name: "Birkenstock", address: "Tokyo, Shinjuku City, Shinjuku, 3 Chome−33−10 新宿モリエール ビル 1F", tag: "SHOP" },
                { area: "新宿", name: "GINZA SIX", address: "Tokyo, Chuo City, Ginza, 6 Chome−10-1", tag: "SHOP" }, 
                { area: "銀座", name: "Uniqlo 旗艦店", address: "Tokyo, Chuo City, Ginza, 6 Chome−9−5", tag: "SHOP" }
            ],
            packingList: {
                "必備證件": ["護照", "信用卡", "身分證", "現金 (日幣/台幣)", "身分證影本", "護照影本", "網卡/漫遊開通"],
                "電子產品": ["手機", "充電線", "行動電源", "萬國插座", "GoPro/相機", "相機電池/記憶卡"],
                "生活雜物": ["衣物", "帽子", "太陽眼鏡", "隱形眼鏡", "梳子", "保養品(乳液/護手霜)", "常備藥(感冒/腸胃/暈車)"]
            }
        };

        // --- Helper Components ---

        const Icon = ({ name, className }) => <i className={`fa-solid fa-${name} ${className}`}></i>;

        const MapButton = ({ address, label = "Google Map" }) => {
            if (!address) return null;
            const openMap = () => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`, '_blank');
            return (
                <button onClick={openMap} className="mt-2 text-xs bg-bp-coffee text-white px-3 py-1.5 rounded-full flex items-center gap-1 active:scale-95 transition-transform">
                    <Icon name="location-dot" /> {label}
                </button>
            );
        };

        // --- Views ---

        const PlanView = ({ data }) => {
            return (
                <div className="space-y-6 pb-24">
                    {/* Header Image Area */}
                    <div className="relative h-40 bg-gradient-to-r from-bp-black to-bp-coffee rounded-b-3xl flex items-center justify-center overflow-hidden border-b-4 border-bp-pink">
                         <div className="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
                         <div className="text-center z-10">
                            <h1 className="text-4xl font-heading text-bp-pink drop-shadow-lg tracking-wider">TOKYO</h1>
                            <p className="text-white text-sm tracking-[0.5em] mt-1">BLACKPINK TRIP</p>
                         </div>
                    </div>

                    {/* Flight & Transport */}
                    <div className="px-4">
                        <h2 className="text-xl font-heading text-white mb-3 flex items-center gap-2">
                            <span className="w-2 h-8 bg-bp-pink rounded-full block"></span> TRANSPORT
                        </h2>
                        <div className="grid gap-3">
                            <div className="bp-card p-4">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-bp-pink font-bold"><Icon name="train" /> 高鐵去程</span>
                                    <span className="text-xs text-gray-400">1/16</span>
                                </div>
                                <p className="text-sm">{data.transport.hsr.outbound}</p>
                                <p className="text-xs text-gray-400 mt-1">{data.transport.hsr.mrt}</p>
                            </div>
                            <div className="bp-card p-4">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-bp-pink font-bold"><Icon name="plane" /> 航班資訊</span>
                                </div>
                                <div className="text-sm space-y-2">
                                    <div className="border-l-2 border-gray-600 pl-2">
                                        <p className="font-bold text-white">去: {data.transport.flight.outbound.airline}</p>
                                        <p className="text-gray-300">{data.transport.flight.outbound.time}</p>
                                    </div>
                                    <div className="border-l-2 border-gray-600 pl-2">
                                        <p className="font-bold text-white">回: {data.transport.flight.inbound.airline}</p>
                                        <p className="text-gray-300">{data.transport.flight.inbound.time}</p>
                                    </div>
                                </div>
                            </div>
                            <div className="bp-card p-4 border-bp-coffee">
                                <h3 className="text-bp-coffee-light font-bold mb-1"><Icon name="hotel" /> {data.transport.hotel.name}</h3>
                                <p className="text-xs text-gray-400 mb-2">{data.transport.hotel.note}</p>
                                <MapButton address={data.transport.hotel.address} label="導航至飯店" />
                            </div>
                        </div>
                    </div>

                    {/* Itinerary Timeline */}
                    <div className="px-4">
                        <h2 className="text-xl font-heading text-white mb-4 flex items-center gap-2">
                            <span className="w-2 h-8 bg-bp-pink rounded-full block"></span> SCHEDULE
                        </h2>
                        <div className="space-y-6">
                            {data.itinerary.map((day, idx) => (
                                <div key={idx} className="bg-bp-dark rounded-xl p-4 shadow-lg border border-gray-800">
                                    <div className="flex justify-between items-end border-b border-gray-700 pb-2 mb-4">
                                        <h3 className="text-2xl font-heading text-bp-pink">{day.day}</h3>
                                        <span className="text-xs text-gray-400 mb-1">{day.date}</span>
                                    </div>
                                    <h4 className="text-lg font-bold text-white mb-4">{day.title}</h4>
                                    
                                    <div className="relative pl-4 border-l-2 border-gray-700 space-y-6">
                                        {day.events.map((evt, eIdx) => (
                                            <div key={eIdx} className="relative">
                                                <div className={`absolute -left-[21px] top-1 w-3 h-3 rounded-full ${evt.type === 'highlight' ? 'bg-bp-pink animate-pulse shadow-glow' : 'bg-gray-600'}`}></div>
                                                <div className="flex flex-col">
                                                    <span className={`text-sm font-bold font-mono ${evt.type === 'highlight' ? 'text-bp-pink' : 'text-bp-coffee-light'}`}>{evt.time}</span>
                                                    <span className="text-base text-gray-200">{evt.title}</span>
                                                    {evt.note && <span className="text-xs text-gray-500 mt-0.5">{evt.note}</span>}
                                                    {evt.address && <MapButton address={evt.address} />}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const CardList = ({ items, type, onAdd }) => {
            const [newItem, setNewItem] = useState({ name: '', address: '', note: '' });
            const [isAdding, setIsAdding] = useState(false);

            const handleAdd = () => {
                if(!newItem.name) return;
                onAdd({ ...newItem, area: 'New', id: Date.now() });
                setNewItem({ name: '', address: '', note: '' });
                setIsAdding(false);
            };

            return (
                <div className="px-4 pb-24 pt-4">
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-heading text-white tracking-widest">{type} GUIDE</h2>
                        <button onClick={() => setIsAdding(!isAdding)} className="bg-bp-pink text-bp-black w-8 h-8 rounded-full flex items-center justify-center font-bold text-xl shadow-glow">
                            {isAdding ? '-' : '+'}
                        </button>
                    </div>

                    {isAdding && (
                        <div className="bg-gray-800 p-4 rounded-lg mb-4 animate-fadeIn border border-bp-pink">
                            <input placeholder="名稱" className="w-full bg-gray-900 p-2 rounded mb-2 text-white border border-gray-700" value={newItem.name} onChange={e=>setNewItem({...newItem, name: e.target.value})} />
                            <input placeholder="地址" className="w-full bg-gray-900 p-2 rounded mb-2 text-white border border-gray-700" value={newItem.address} onChange={e=>setNewItem({...newItem, address: e.target.value})} />
                            <input placeholder="備註 (如: 必吃)" className="w-full bg-gray-900 p-2 rounded mb-2 text-white border border-gray-700" value={newItem.note} onChange={e=>setNewItem({...newItem, note: e.target.value})} />
                            <button onClick={handleAdd} className="w-full bg-bp-coffee text-white py-2 rounded font-bold">新增至清單</button>
                        </div>
                    )}

                    <div className="grid grid-cols-1 gap-4">
                        {items.map((item, idx) => (
                            <div key={idx} className="bg-bp-dark rounded-lg overflow-hidden border border-gray-800 shadow-card flex flex-col">
                                <div className="p-4 flex-1">
                                    <div className="flex justify-between items-start">
                                        <span className="text-xs bg-gray-800 text-bp-pink px-2 py-0.5 rounded uppercase tracking-wide">{item.area}</span>
                                        {item.tag && <span className="text-xs bg-bp-coffee text-white px-2 py-0.5 rounded">{item.tag}</span>}
                                    </div>
                                    <h3 className="text-lg font-bold text-white mt-2 leading-tight">{item.name}</h3>
                                    {item.note && <p className="text-sm text-gray-400 mt-1 italic">{item.note}</p>}
                                </div>
                                <div className="px-4 pb-4">
                                    <button 
                                        onClick={() => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.address)}`, '_blank')}
                                        className="w-full bg-gray-800 hover:bg-gray-700 text-gray-300 text-sm py-2 rounded flex items-center justify-center gap-2 border border-gray-700 transition-colors"
                                    >
                                        <Icon name="location-arrow" /> GOOGLE MAP
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ListsView = ({ initialPacking }) => {
            const [activeSubTab, setActiveSubTab] = useState('PACK'); // PACK, SHOP, MEMO
            
            // CheckList State
            const [checks, setChecks] = useState(() => JSON.parse(localStorage.getItem('trip_checks') || '{}'));
            const toggleCheck = (key) => {
                const newChecks = { ...checks, [key]: !checks[key] };
                setChecks(newChecks);
                localStorage.setItem('trip_checks', JSON.stringify(newChecks));
            };

            // Memo State
            const [memo, setMemo] = useState(() => localStorage.getItem('trip_memo') || '');
            useEffect(() => localStorage.setItem('trip_memo', memo), [memo]);

            // Shopping List State
            const [shopList, setShopList] = useState(() => JSON.parse(localStorage.getItem('trip_shoplist') || '[]'));
            const [newShopItem, setNewShopItem] = useState('');
            const addShopItem = () => {
                if(!newShopItem) return;
                const newList = [...shopList, { id: Date.now(), text: newShopItem, done: false }];
                setShopList(newList);
                localStorage.setItem('trip_shoplist', JSON.stringify(newList));
                setNewShopItem('');
            };
            const toggleShopItem = (id) => {
                const newList = shopList.map(i => i.id === id ? { ...i, done: !i.done } : i);
                setShopList(newList);
                localStorage.setItem('trip_shoplist', JSON.stringify(newList));
            };
            const deleteShopItem = (id) => {
                const newList = shopList.filter(i => i.id !== id);
                setShopList(newList);
                localStorage.setItem('trip_shoplist', JSON.stringify(newList));
            };

            // Helper to render text with links
            const renderTextWithLinks = (text) => {
                const urlRegex = /(https?:\/\/[^\s]+)/g;
                const parts = text.split(urlRegex);
                return parts.map((part, i) => 
                    urlRegex.test(part) ? <a key={i} href={part} target="_blank" className="text-bp-pink underline break-all">{part}</a> : part
                );
            };

            return (
                <div className="pb-24 pt-4 h-full flex flex-col">
                    <div className="px-4 mb-4">
                        <div className="flex bg-gray-800 rounded-lg p-1">
                            {['PACK', 'SHOP', 'MEMO'].map(tab => (
                                <button 
                                    key={tab}
                                    onClick={() => setActiveSubTab(tab)}
                                    className={`flex-1 py-2 text-sm font-bold rounded-md transition-all ${activeSubTab === tab ? 'bg-bp-pink text-black shadow-md' : 'text-gray-400'}`}
                                >
                                    {tab === 'PACK' && '必備'}
                                    {tab === 'SHOP' && '購物'}
                                    {tab === 'MEMO' && '備忘'}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="flex-1 overflow-y-auto px-4 tab-content">
                        {activeSubTab === 'PACK' && (
                            <div className="space-y-6">
                                {Object.entries(initialPacking).map(([category, items]) => (
                                    <div key={category}>
                                        <h3 className="text-bp-coffee-light font-bold mb-2 border-b border-gray-800 pb-1">{category}</h3>
                                        <div className="space-y-2">
                                            {items.map(item => (
                                                <div key={item} onClick={() => toggleCheck(item)} className="flex items-center gap-3 p-3 bg-bp-dark rounded-lg active:scale-[0.98] transition-transform">
                                                    <div className={`w-5 h-5 rounded border flex items-center justify-center ${checks[item] ? 'bg-bp-pink border-bp-pink' : 'border-gray-500'}`}>
                                                        {checks[item] && <Icon name="check" className="text-black text-xs" />}
                                                    </div>
                                                    <span className={checks[item] ? 'text-gray-500 line-through' : 'text-white'}>{item}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeSubTab === 'SHOP' && (
                            <div>
                                <div className="flex gap-2 mb-4">
                                    <input 
                                        type="text" 
                                        className="flex-1 bg-gray-800 text-white px-4 py-2 rounded-lg outline-none border border-transparent focus:border-bp-pink"
                                        placeholder="輸入想買的東西..."
                                        value={newShopItem}
                                        onChange={(e) => setNewShopItem(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && addShopItem()}
                                    />
                                    <button onClick={addShopItem} className="bg-bp-coffee text-white px-4 rounded-lg"><Icon name="plus" /></button>
                                </div>
                                <div className="space-y-2">
                                    {shopList.map(item => (
                                        <div key={item.id} className="flex items-center justify-between p-3 bg-bp-dark rounded-lg">
                                            <div className="flex items-center gap-3 flex-1 overflow-hidden" onClick={() => toggleShopItem(item.id)}>
                                                <div className={`w-5 h-5 min-w-[1.25rem] rounded border flex items-center justify-center ${item.done ? 'bg-gray-600 border-gray-600' : 'border-bp-pink'}`}>
                                                    {item.done && <Icon name="check" className="text-white text-xs" />}
                                                </div>
                                                <span className={`truncate ${item.done ? 'text-gray-600 line-through' : 'text-white'}`}>
                                                    {renderTextWithLinks(item.text)}
                                                </span>
                                            </div>
                                            <button onClick={() => deleteShopItem(item.id)} className="text-gray-600 hover:text-red-500 px-2">
                                                <Icon name="trash" />
                                            </button>
                                        </div>
                                    ))}
                                    {shopList.length === 0 && <div className="text-center text-gray-500 mt-10">尚無購物清單，快去買爆！</div>}
                                </div>
                            </div>
                        )}

                        {activeSubTab === 'MEMO' && (
                            <div className="h-full">
                                <textarea 
                                    className="w-full h-96 bg-bp-dark text-white p-4 rounded-lg border border-gray-700 focus:border-bp-pink outline-none leading-relaxed"
                                    placeholder="在此輸入筆記，網址會自動變成連結..."
                                    value={memo}
                                    onChange={(e) => setMemo(e.target.value)}
                                ></textarea>
                                <div className="mt-4 p-4 bg-gray-900 rounded-lg text-sm text-gray-400 break-words border border-gray-800">
                                    <p className="mb-2 font-bold text-gray-500">預覽 (可點擊連結):</p>
                                    <div className="whitespace-pre-wrap">{renderTextWithLinks(memo)}</div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const InfoView = () => {
            return (
                <div className="px-6 py-8 space-y-6 pb-24">
                    <h2 className="text-3xl font-heading text-center text-white mb-8">INFO</h2>
                    
                    <div className="grid grid-cols-2 gap-4">
                         <a href="https://www.jma.go.jp/en/jma/index.html" target="_blank" className="bg-blue-900/50 p-6 rounded-xl flex flex-col items-center justify-center gap-2 border border-blue-800 active:scale-95 transition-transform">
                            <Icon name="cloud-sun" className="text-4xl text-blue-400" />
                            <span className="font-bold">天氣預報</span>
                        </a>
                         <a href="tel:110" className="bg-red-900/50 p-6 rounded-xl flex flex-col items-center justify-center gap-2 border border-red-800 active:scale-95 transition-transform">
                            <Icon name="phone" className="text-4xl text-red-400" />
                            <span className="font-bold">警察 110</span>
                        </a>
                        <a href="tel:119" className="bg-red-900/50 p-6 rounded-xl flex flex-col items-center justify-center gap-2 border border-red-800 active:scale-95 transition-transform">
                            <Icon name="ambulance" className="text-4xl text-red-400" />
                            <span className="font-bold">救護 119</span>
                        </a>
                         <div className="bg-gray-800 p-6 rounded-xl flex flex-col items-center justify-center gap-2 border border-gray-700">
                            <Icon name="passport" className="text-4xl text-gray-400" />
                            <span className="font-bold text-center text-sm">護照隨身帶</span>
                        </div>
                    </div>

                    <div className="bg-bp-card p-6 rounded-xl mt-6">
                        <h3 className="text-bp-pink font-bold mb-4 text-lg border-b border-gray-700 pb-2">注意事項</h3>
                        <ul className="list-disc pl-5 space-y-2 text-sm text-gray-300">
                            <li>日本電壓 100V (台灣插頭可用)。</li>
                            <li>走路不抽菸，請至指定吸菸區。</li>
                            <li>搭乘電車請將手機設為靜音。</li>
                            <li>入境禁止攜帶肉類製品、新鮮蔬果。</li>
                            <li>購物滿 5000 日圓(未稅)可退稅，需出示護照。</li>
                        </ul>
                    </div>
                    
                    <div className="text-center mt-10 opacity-50">
                        <Icon name="heart" className="text-bp-pink animate-pulse" />
                        <p className="text-xs mt-2">Have a Safe Trip!</p>
                    </div>
                </div>
            );
        };

        // --- Main App Component ---

        const App = () => {
            const [activeTab, setActiveTab] = useState('PLAN');
            
            // Persistent State for added places
            const [myFoods, setMyFoods] = useState(() => JSON.parse(localStorage.getItem('trip_foods') || '[]'));
            const [myPlaces, setMyPlaces] = useState(() => JSON.parse(localStorage.getItem('trip_places') || '[]'));

            const handleAddFood = (item) => {
                const newList = [...myFoods, item];
                setMyFoods(newList);
                localStorage.setItem('trip_foods', JSON.stringify(newList));
            };

            const handleAddPlace = (item) => {
                const newList = [...myPlaces, item];
                setMyPlaces(newList);
                localStorage.setItem('trip_places', JSON.stringify(newList));
            };

            // Merge initial data with user data
            const foods = useMemo(() => [...INITIAL_DATA.foods, ...myFoods], [myFoods]);
            const places = useMemo(() => [...INITIAL_DATA.places, ...myPlaces], [myPlaces]);

            const renderContent = () => {
                switch(activeTab) {
                    case 'PLAN': return <PlanView data={INITIAL_DATA} />;
                    case 'FOOD': return <CardList items={foods} type="FOOD" onAdd={handleAddFood} />;
                    case 'PLAY': return <CardList items={places} type="PLAY" onAdd={handleAddPlace} />;
                    case 'LISTS': return <ListsView initialPacking={INITIAL_DATA.packingList} />;
                    case 'INFO': return <InfoView />;
                    default: return <PlanView data={INITIAL_DATA} />;
                }
            };

            return (
                <div className="min-h-screen bg-bp-black text-white relative max-w-md mx-auto shadow-2xl overflow-hidden">
                    {/* Content Area */}
                    <div className="h-full overflow-y-auto custom-scrollbar">
                        {renderContent()}
                    </div>

                    {/* Bottom Navigation */}
                    <div className="fixed bottom-0 left-0 right-0 bg-bp-black/95 backdrop-blur-md border-t border-gray-800 pb-safe pt-2 px-2 z-50 max-w-md mx-auto">
                        <div className="flex justify-around items-center h-16">
                            {[
                                { id: 'PLAN', icon: 'calendar-days', label: '行程' },
                                { id: 'FOOD', icon: 'utensils', label: '美食' },
                                { id: 'PLAY', icon: 'camera-retro', label: '景點' },
                                { id: 'LISTS', icon: 'list-check', label: '清單' },
                                { id: 'INFO', icon: 'circle-info', label: '資訊' }
                            ].map(tab => (
                                <button 
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex flex-col items-center justify-center w-14 transition-all duration-300 ${activeTab === tab.id ? 'text-bp-pink -translate-y-2' : 'text-gray-500'}`}
                                >
                                    <div className={`text-xl mb-1 ${activeTab === tab.id ? 'drop-shadow-[0_0_5px_rgba(255,105,180,0.8)]' : ''}`}>
                                        <Icon name={tab.icon} />
                                    </div>
                                    <span className="text-[10px] font-bold">{tab.label}</span>
                                    {activeTab === tab.id && <div className="w-1 h-1 bg-bp-pink rounded-full mt-1"></div>}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
